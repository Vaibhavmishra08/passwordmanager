<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strong Password Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for the range slider */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
            margin-top: -8px;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-slate-900 flex items-center justify-center min-h-screen text-white">

    <div class="w-full max-w-md mx-auto p-4 sm:p-6 md:p-8">
        <div class="bg-slate-800 rounded-2xl shadow-2xl p-6 sm:p-8">
            <h1 class="text-2xl sm:text-3xl font-bold text-center mb-6 text-indigo-400">Password Generator</h1>

            <!-- Display for Generated Password -->
            <div class="relative mb-6">
                <input type="text" id="passwordOutput" readonly
                    class="w-full bg-slate-900 border-2 border-slate-700 rounded-lg p-4 text-lg text-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 pr-24"
                    placeholder="Your password will appear here">
                <div class="absolute inset-y-0 right-0 flex items-center">
                    <button id="regenerateButton"
                        class="flex items-center px-3 text-slate-400 hover:text-indigo-400 transition-colors duration-200" title="Generate new password">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                    </button>
                    <button id="copyButton"
                        class="flex items-center px-3 text-slate-400 hover:text-indigo-400 transition-colors duration-200" title="Copy to clipboard">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>

            <!-- Password Length Slider -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <label for="length" class="text-slate-300 font-medium">Password Length</label>
                    <span id="lengthValue" class="text-indigo-400 font-semibold text-lg">16</span>
                </div>
                <input type="range" id="length" min="8" max="32" value="16"
                    class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer">
            </div>

            <!-- Character Type Checkboxes -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                <div class="flex items-center bg-slate-900/50 p-3 rounded-lg">
                    <input type="checkbox" id="includeUppercase" checked class="w-5 h-5 text-indigo-500 bg-slate-700 border-slate-600 rounded focus:ring-indigo-600 ring-offset-slate-800 focus:ring-2">
                    <label for="includeUppercase" class="ml-3 text-slate-300">Include Uppercase (A-Z)</label>
                </div>
                <div class="flex items-center bg-slate-900/50 p-3 rounded-lg">
                    <input type="checkbox" id="includeLowercase" checked class="w-5 h-5 text-indigo-500 bg-slate-700 border-slate-600 rounded focus:ring-indigo-600 ring-offset-slate-800 focus:ring-2">
                    <label for="includeLowercase" class="ml-3 text-slate-300">Include Lowercase (a-z)</label>
                </div>
                <div class="flex items-center bg-slate-900/50 p-3 rounded-lg">
                    <input type="checkbox" id="includeNumbers" checked class="w-5 h-5 text-indigo-500 bg-slate-700 border-slate-600 rounded focus:ring-indigo-600 ring-offset-slate-800 focus:ring-2">
                    <label for="includeNumbers" class="ml-3 text-slate-300">Include Numbers (0-9)</label>
                </div>
                <div class="flex items-center bg-slate-900/50 p-3 rounded-lg">
                    <input type="checkbox" id="includeSymbols" checked class="w-5 h-5 text-indigo-500 bg-slate-700 border-slate-600 rounded focus:ring-indigo-600 ring-offset-slate-800 focus:ring-2">
                    <label for="includeSymbols" class="ml-3 text-slate-300">Include Symbols (!@#$)</label>
                </div>
            </div>

            <!-- Generate Button -->
            <button id="generateButton"
                class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-4 rounded-lg text-lg transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-500/50">
                Generate Password
            </button>
             <!-- Message Box -->
            <div id="messageBox" class="mt-4 text-center text-green-400 font-medium opacity-0 transition-opacity duration-300"></div>
        </div>
    </div>

    <script>
        // --- DOM Element References ---
        const passwordOutput = document.getElementById('passwordOutput');
        const lengthSlider = document.getElementById('length');
        const lengthValue = document.getElementById('lengthValue');
        const includeUppercase = document.getElementById('includeUppercase');
        const includeLowercase = document.getElementById('includeLowercase');
        const includeNumbers = document.getElementById('includeNumbers');
        const includeSymbols = document.getElementById('includeSymbols');
        const generateButton = document.getElementById('generateButton');
        const copyButton = document.getElementById('copyButton');
        const regenerateButton = document.getElementById('regenerateButton'); // New button
        const messageBox = document.getElementById('messageBox');

        // --- Character Sets ---
        const uppercaseChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const lowercaseChars = 'abcdefghijklmnopqrstuvwxyz';
        const numberChars = '0123456789';
        const symbolChars = '!@#$%^&*()_+-=[]{}|;:,.<>?';

        // --- Event Listeners ---

        // Update the length display when the slider is moved
        lengthSlider.addEventListener('input', (event) => {
            lengthValue.textContent = event.target.value;
        });

        // Generate a new password when the main button is clicked
        generateButton.addEventListener('click', generatePassword);
        
        // Generate a new password when the icon button is clicked
        regenerateButton.addEventListener('click', generatePassword);

        // Copy password to clipboard
        copyButton.addEventListener('click', copyToClipboard);

        // --- Core Functions ---

        /**
         * Generates a password based on user-selected criteria.
         */
        function generatePassword() {
            // Get the desired length from the slider
            const length = parseInt(lengthSlider.value);

            // Build a string of all allowed characters based on checkboxes
            let allowedChars = '';
            let requiredChars = [];
            
            if (includeUppercase.checked) {
                allowedChars += uppercaseChars;
                requiredChars.push(getRandomChar(uppercaseChars));
            }
            if (includeLowercase.checked) {
                allowedChars += lowercaseChars;
                requiredChars.push(getRandomChar(lowercaseChars));
            }
            if (includeNumbers.checked) {
                allowedChars += numberChars;
                requiredChars.push(getRandomChar(numberChars));
            }
            if (includeSymbols.checked) {
                allowedChars += symbolChars;
                requiredChars.push(getRandomChar(symbolChars));
            }

            // Check if at least one character set is selected
            if (allowedChars === '') {
                showMessage('Please select at least one character type.', 'error');
                passwordOutput.value = '';
                return;
            }
            
            // Check if the required characters exceed the password length
            if (requiredChars.length > length) {
                showMessage('Password length is too short for all selected character types.', 'error');
                passwordOutput.value = '';
                return;
            }

            let password = '';
            // Add the remaining characters randomly
            const remainingLength = length - requiredChars.length;
            for (let i = 0; i < remainingLength; i++) {
                password += getRandomChar(allowedChars);
            }
            
            // Add the required characters to the password
            password += requiredChars.join('');

            // Shuffle the password to ensure randomness
            passwordOutput.value = shuffleString(password);
            showMessage('New password generated!', 'success');
        }

        /**
         * Copies the generated password from the output field to the clipboard.
         */
        function copyToClipboard() {
            const password = passwordOutput.value;
            if (!password) {
                showMessage('Nothing to copy!', 'error');
                return;
            }

            // The 'navigator.clipboard' API is more modern but can be restricted in some environments (like iframes).
            // We'll use a fallback for broader compatibility.
            if (navigator.clipboard) {
                navigator.clipboard.writeText(password).then(() => {
                    showMessage('Password copied to clipboard!', 'success');
                }).catch(err => {
                    // Fallback to the older method if the modern one fails
                    fallbackCopyTextToClipboard(password);
                });
            } else {
                fallbackCopyTextToClipboard(password);
            }
        }
        
        /**
         * A fallback method for copying text that works in more environments.
         */
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showMessage('Password copied to clipboard!', 'success');
                } else {
                    showMessage('Copying failed.', 'error');
                }
            } catch (err) {
                showMessage('Copying failed.', 'error');
            }

            document.body.removeChild(textArea);
        }

        // --- Helper Functions ---

        /**
         * Gets a single random character from a given string.
         * @param {string} charSet - The string of characters to choose from.
         * @returns {string} A single random character.
         */
        function getRandomChar(charSet) {
            const randomIndex = Math.floor(Math.random() * charSet.length);
            return charSet[randomIndex];
        }
        
        /**
         * Shuffles the characters of a string randomly.
         * @param {string} s - The string to shuffle.
         * @returns {string} The shuffled string.
         */
        function shuffleString(s) {
            const arr = s.split('');
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]]; // Swap elements
            }
            return arr.join('');
        }
        
        /**
         * Displays a message to the user and fades it out.
         * @param {string} text - The message to display.
         * @param {'success'|'error'} type - The type of message.
         */
        function showMessage(text, type) {
            messageBox.textContent = text;
            messageBox.className = `mt-4 text-center font-medium transition-opacity duration-300 ${type === 'success' ? 'text-green-400' : 'text-red-500'}`;
            messageBox.style.opacity = 1;
            
            setTimeout(() => {
                messageBox.style.opacity = 0;
            }, 2000);
        }
        
        // --- Initial Password Generation ---
        // Generate a password on page load so it's not empty.
        window.onload = generatePassword;

    </script>
</body>
</html>
